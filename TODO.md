# 朝たん計算アプリ v2.0 - 残りのTODO

## ✅ 完了済み
1. ✅ Bunでプロジェクトセットアップ（Solid.js + Vite）
2. ✅ テスト環境の構築（Vitest設定）
3. ✅ Food型定義とテストの実装（TDD）
4. ✅ ProteinCalculatorサービスの実装（TDD）
5. ✅ FoodCardコンポーネントの実装（TDD）
6. ✅ ProteinCounterコンポーネントの実装（TDD）
7. ✅ 既存の画像アセットを移行（36品目）
8. ✅ 食品データの移行とカテゴリー分類
9. ✅ App統合実装（メインレイアウト）
10. ✅ README.md更新

## 🚀 アーキテクチャ変更

### バックエンド追加（Bun + Hono + SQLite）
- [x] バックエンドディレクトリ構造作成
- [x] Bun + Honoでサーバー構築
- [x] SQLiteデータベースセットアップ
- [x] 文科省食品データ自動インポートスクリプト
- [x] REST APIエンドポイント実装
  - [x] `/api/foods` - 食品一覧・検索
  - [x] `/api/meals/generate` - 献立自動生成
  - [x] `/api/meals/patterns` - 献立パターン取得
  - [x] `/api/admin/update` - 手動データ更新

### 自動更新システム
- [ ] GitHub Actionsワークフロー作成
- [ ] 月次自動更新設定
- [ ] データバリデーション機能
- [ ] 差分更新とバックアップ機能

## 📝 残りのタスク

### 高優先度 🔴

#### 1. ✅ MealPatternsコンポーネント（献立機能）
- [x] API連携で献立パターンを取得
- [x] ワンタップで献立を選択する機能
- [x] 献立のタンパク質合計表示
- [x] カテゴリー別フィルタリング機能
- [x] 人気順/タンパク質順ソート機能

#### 2. ✅ MealRecommenderサービス（レコメンド機能）
- [x] 選択した食品に基づく組み合わせ提案ロジック
- [x] 20gまでの不足分を補う食品の提案
- [x] カテゴリーバランスを考慮した提案
- [x] 効率的な組み合わせのスコアリング

#### 3. ShareButtonコンポーネント（SNSシェア機能）
- [ ] 選択メニューのテキスト生成
- [ ] X（Twitter）シェアURL生成
- [ ] LINEシェア機能
- [ ] 画像生成機能（Canvas API使用）

### 中優先度 🟡

#### 4. 多言語対応（i18n）
- [ ] i18nライブラリの導入（@solid-primitives/i18n）
- [ ] 言語ファイルの作成
  - 日本語（ja）
  - 英語（en）
  - 中国語（zh）
  - 韓国語（ko）
- [ ] 言語切り替えUIコンポーネント
- [ ] 食品名の翻訳対応
- [ ] 画像のalt属性多言語化

#### 5. スタイリング改善
- [ ] ポケモン風デザインの深化
- [ ] ダークモード対応
- [ ] アクセシビリティ改善
  - [ ] WCAG 2.1 Level A準拠（必須）
    - [ ] 適切な見出し階層
    - [ ] フォーカス管理
    - [ ] キーボード操作対応
    - [ ] 代替テキスト
  - [ ] WCAG 2.1 Level AA準拠（目標）
    - [ ] コントラスト比4.5:1以上
    - [ ] フォーカスインジケーター強化
    - [ ] エラーメッセージの明確化
    - [ ] タッチターゲット44×44px以上

#### 6. パフォーマンス最適化
- [ ] 画像の遅延読み込み最適化
- [ ] WebP形式への変換
- [ ] Service Worker実装（オフライン対応）
- [ ] Lighthouse スコア100点達成

### 低優先度 🟢

#### 7. 追加機能
- [ ] お気に入り機能（LocalStorage使用）
- [ ] 履歴機能（過去の選択を記録）
- [ ] カスタム食品追加機能
- [ ] 栄養素詳細表示（カロリー、脂質など）

#### 8. テスト改善
- [ ] E2Eテスト追加（Playwright）
- [ ] ビジュアルリグレッションテスト
- [ ] パフォーマンステスト

#### 9. デプロイ・運用
- [ ] GitHub Actions CI/CD設定
- [ ] Vercel/Netlifyへのデプロイ設定
- [ ] Google Analytics設定
- [ ] エラー監視（Sentry）

## 💡 今後の改善アイデア

### 機能面
- AI食事提案（OpenAI API連携）
- バーコードスキャン機能
- 食事写真からタンパク質推定
- Apple Health/Google Fit連携

### UI/UX
- 3Dカード表示（Three.js）
- ゲーミフィケーション要素
  - 連続達成記録
  - バッジシステム
  - ランキング機能
- PWA化（インストール可能に）

### 技術的改善
- SSG/SSR対応（SolidStart）
- GraphQL API化
- マイクロフロントエンド化
- WebAssembly活用

## 📌 次回作業時の開始点

1. MealPatternsコンポーネントのTDD実装から開始
2. `bun run dev`で開発サーバー起動
3. `bun run test:watch`でテスト監視モード

## 🔧 現在の技術的な課題

- App統合テストで1件失敗（7件中6件成功）
  - カテゴリー表示のテストを調整が必要
- 献立パターンAPIのJSONパース処理の修正が必要
- TypeScript strictモードの設定検討
- Bundle size最適化の余地あり

## ✅ 2025-08-21 完了項目

### バックエンド実装
- Bun + Hono + SQLiteでバックエンドサーバー構築
- データベーススキーマ設計と実装
- 初期データ（36品目）の投入
- 文科省食品データインポートスクリプト作成
- 献立パターン自動生成スクリプト作成（29パターン生成）
- REST APIエンドポイント実装
  - `/api/foods` - 食品一覧・検索（動作確認済み）
  - `/api/meals/patterns` - 献立パターン取得
  - `/api/meals/generate` - 献立自動生成
  - `/api/admin/update` - 管理者用データ更新

### 開発環境
- バックエンド用TypeScript設定
- データベース管理スクリプト（db:setup, db:update, db:seed）
- APIサーバー（http://localhost:3001）の起動確認

## ✅ 2025-08-23 完了項目

### フロントエンド実装
- MealPatternsコンポーネントの実装（TDD）
  - API連携で献立パターン取得
  - カテゴリーフィルター機能
  - ソート機能（人気順/タンパク質順）
  - 献立詳細表示と選択機能
- MealRecommenderサービスの実装（TDD）
  - 食品レコメンデーションロジック
  - 組み合わせ提案機能
  - カテゴリーバランス考慮

### バックエンド修正
- SQLiteのJSONパースエラー修正（GROUP_CONCAT → json_group_array）

### ドキュメント
- DEVELOPMENT.mdにアーキテクチャ図追加
- データフロー説明の追加

---

最終更新: 2025-08-23 20:00
作業時間: 約1.5時間
進捗: レコメンド機能完了、全体進捗90%